apply plugin: 'com.android.application'
apply plugin: 'idea'
apply plugin: 'android-apt'

//sourceSets {
//    apt {
//        java {
//            srcDir 'build/generated/source/apt'
//        }
//    }
//}

apt {
    arguments {
        variantName variant.name
        resourcePackageName android.defaultConfig.applicationId
    }
}

android {
    compileSdkVersion 24
    buildToolsVersion "24.0.0"

    defaultConfig {
        applicationId "com.oridev.variantsstubsgenerator.sample"
        minSdkVersion 15
        targetSdkVersion 24
        versionCode 1
        versionName "1.0"
    }
    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
    }

    productFlavors {

        flavor1 {}

        flavor2 {}
    }

//    applicationVariants.all { variant ->
//        def aptOutputDir = project.file("build/generated/source/apt")
//        def aptOutput = new File(aptOutputDir, variant.dirName)
//
//        sourceSets {
//            apt {
//                java {
//                    srcDir aptOutput
//                }
//            }
//        }
//
//        android.sourceSets[getSourceSetName(variant)].java.srcDirs+= aptOutput.getPath()
//
//        variant.javaCompile.options.compilerArgs += [
//                '-processorpath', configurations.compile.getAsPath(),
//                '-s', aptOutput
//        ]
//        variant.javaCompile.source = variant.javaCompile.source.filter { p ->
//            return !p.getPath().startsWith(aptOutputDir.getPath())
//        }
//
//        variant.javaCompile.doFirst {
//            aptOutput.mkdirs()
//        }
//    }
}


dependencies {

    compile fileTree(include: ['*.jar'], dir: 'libs')

    compile 'com.android.support:appcompat-v7:24.2.0'

    compile project(':variantsstubsgenerator-annotation')
    apt project(':variantsstubsgenerator-compiler')

    compile 'com.jakewharton:butterknife:8.2.1'
    apt 'com.jakewharton:butterknife-compiler:8.2.1'

    testCompile 'junit:junit:4.12'

}


//def getSourceSetName(variant) {
//    return new File(variant.dirName).getName();
//}
